<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' vulnerabledoma.in">
    <script>
        document.addEventListener('securitypolicyviolation', e => {
            console.dir(e);
            alert(e.blockedURI);
        });
    </script>
</head>
<body>
    <button id="test1">TEST 1</button>
    <button id="test2">TEST 2</button>
    <button id="test3">TEST 3</button>

    <script>
        document.getElementById('test1').onclick = function() {
            window.open('https://vulnerabledoma.in/fx_csp_violation_leak_302.php');
        };
        document.getElementById('test2').onclick = function() {
            window.location.href = 'https://www.vulnerabledoma.in/path?query';
        };
        document.getElementById('test3').onclick = function() {
            const link = document.createElement('a');
            link.href = 'https://www.vulnerabledoma.in/path?query';
            link.click();
        };
    </script>
</body>
</html>
